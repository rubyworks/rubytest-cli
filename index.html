<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Ruby Test CLI by rubyworks</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header">Ruby Test CLI</h1>
        <p class="header">Command-line Interface for Ruby Test</p>

        <ul>
          <li class="download"><a class="buttons" href="https://github.com/rubyworks/rubytest-cli/zipball/master">Download ZIP</a></li>
          <li class="download"><a class="buttons" href="https://github.com/rubyworks/rubytest-cli/tarball/master">Download TAR</a></li>
          <li><a class="buttons github" href="https://github.com/rubyworks/rubytest-cli">View On GitHub</a></li>
        </ul>

        <p class="header">This project is maintained by <a class="header name" href="https://github.com/rubyworks">rubyworks</a></p>


      </header>
      <section>
        <h1>Ruby Test CLI</h1>

<p>Command line interface for running tests for RubyTest-based
test frameworks.</p>

<p><a href="http://rubyworks.github.com/rubytest-cli">Website</a> /
<a href="http://github.com/rubyworks/rubytest-cli/issues">Support</a> /
<a href="http://github.com/rubyworks/rubytest-cli">Development</a></p>

<h2>Usage</h2>

<p>The rubytest command-line tool follows many of the usual conventions
so it's use is farily straightforward. The <code>-h/--help</code> option is 
available to detail all its options. Here is a basic example of usage. </p>

<pre><code>$ rubytest -Ilib test/*_test.rb
</code></pre>

<p>This would add <code>lib</code> to Ruby's $LOAD_PATH and then load all the 
test files matching the <code>test/*_test.rb</code> glob.</p>

<p>When running tests, you need to be sure to load in your test framework
or your framework's Ruby Test adapter. This is usually done via a helper
script in the test files, but might also be done via command line options,
e.g.</p>

<pre><code>$ rubytest -r lemon -r ae test/test_*.rb
</code></pre>

<p>Of course, it can become tedious having to type such a long command
over and over. One way to handle this is to use an a <em>runtime adjunct tool</em>
like <a href="http://rubyworks.github.com/dotopts">DotOpts</a>. For example, a project
might add a <code>.opts</code> file with the entry:</p>

<pre><code>rubytest
  -f progress
  -r spectroscope
  -r rspecial
  spec/spec_*.rb
</code></pre>

<p>That will work in many cases, but to make things solid Ruby Test
supports default pre-configuration files. To use, add an <code>etc/test.rb</code> file
to a project and add <code>Test.run</code> (or the alias <code>Test.configure</code>) entries.</p>

<div class="highlight"><pre>    <span class="no">Test</span><span class="o">.</span><span class="n">run</span> <span class="k">do</span> <span class="o">|</span><span class="n">r</span><span class="o">|</span>
      <span class="n">r</span><span class="o">.</span><span class="n">loadpath</span> <span class="s1">'lib'</span>
      <span class="n">r</span><span class="o">.</span><span class="n">test_files</span> <span class="o">&lt;&lt;</span> <span class="s1">'test/*_test.rb'</span>
    <span class="k">end</span>

    <span class="no">Test</span><span class="o">.</span><span class="n">run</span> <span class="s1">'coverage'</span> <span class="k">do</span> <span class="o">|</span><span class="n">r</span><span class="o">|</span>
      <span class="n">r</span><span class="o">.</span><span class="n">loadpath</span> <span class="s1">'lib'</span>
      <span class="n">r</span><span class="o">.</span><span class="n">test_files</span> <span class="o">&lt;&lt;</span> <span class="s1">'test/*_test.rb'</span>
      <span class="n">r</span><span class="o">.</span><span class="n">before</span> <span class="k">do</span>
        <span class="nb">require</span> <span class="s1">'simplecov'</span>
        <span class="no">Simplecov</span><span class="o">.</span><span class="n">setup</span> <span class="k">do</span> <span class="o">|</span><span class="n">s</span><span class="o">|</span>
          <span class="n">s</span><span class="o">.</span><span class="n">filter</span> <span class="s1">'test/'</span>
          <span class="n">s</span><span class="o">.</span><span class="n">command_name</span> <span class="no">File</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="vg">$0</span><span class="p">)</span>
          <span class="n">s</span><span class="o">.</span><span class="n">coverage_dir</span> <span class="s1">'log/coverage'</span>    
        <span class="k">end</span>
        <span class="c1"># to ensure proper coverage</span>
        <span class="nb">require</span> <span class="s1">'myapp'</span>
      <span class="k">end</span>
    <span class="k">end</span>
</pre></div>

<p>Now when <code>rubytest</code> is used the first configuration will apply. To use
the 'coverage' configuration use <code>-p/--profile</code> option.</p>

<pre><code>$ rubytest -p coverage
</code></pre>

<p>In this manner your project can have any number of different test
configurations, and it is easy to select between them.</p>

<p>Note that the above example could have used <code>Test.configure</code> instead
of <code>Test.run</code>. They do the same thing. But do not use <code>Test.run!</code> because
that will cause testing to be run immediately.</p>

<p>The configuration file can be in the <code>config</code> directory instead of <code>etc</code>, which
is nice for Rails projects. But if you prefer a file in the project's root 
then either <code>Testfile</code> or <code>.test</code> can be also be used instead. All of these
locations are supported simply because no one configuration convention has 
taken a solid hold in the Ruby community. However, we highly recommend using
<code>etc/test.rb</code>. In the end that seems like the best overall convention
(and beleive me, I've analyized the hell out of every option!).</p>

<h2>Copyrights</h2>

<p>Rubytest CLI is copyrighted open-source software.</p>

<pre><code>Copyright (c) 2013 Rubyworks. All rights reserved.
</code></pre>

<p>It is redistributable and modifiable in accordance with the terms of the
[BSD-2-Clause] license.</p>

<p>See LICENSE.txt for the full text.</p>
      </section>
      <footer>
        <p><small>Hosted on <a href="https://pages.github.com">GitHub Pages</a> using the Dinky theme</small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
		
  </body>
</html>